---
title: 11-指针和数组
description: 
published: true
date: 2021-02-21T13:37:36.168Z
tags: 
editor: undefined
dateCreated: 2021-02-21T13:24:10.959Z
---

# 指针和数组

{{< details title="要点回顾：" open=true >}}

1. 数组名是一个指针常量，指针的指向不可以修改，指针指向的值可以修改
2. 指针计算不是简单的整数加减，而是加减一个类型大小
3. 指针数组，它是数组，数组的每个元素都是指针类型

{{< /details >}}

## 数组名

数组名字是数组的首元素地址，但它是一个常量：

```c
int a[] = { 1, 2, 3, 4, 5, 6, 7, 8, 9 };
printf("a = %p\n", a);
printf("&a[0] = %p\n", &a[0]);

// a = 10; // err, 数组名只是常量，不能修改
```

## 指针操作数组元素

```c
#include "stdio.h"

int main(int argc, char const *argv[]) {
    int arr[] = {1, 2, 3};
		int n = sizeof(arr) / sizeof(int);
    printf("%p \n", arr); // 0x7fff48cf3bbc 数组名是地址

		/**
			--------------------------------------------------------
			| 0x7fff48cf3bbc |  0x7fff48cf3bc1 |   0x7fff48cf3bc5  | // 一个值四个字节大小
			--------------------------------------------------------
			|    1           |       2         |       3           |
			--------------------------------------------------------
			     arr[0]            arr[1]            arr[2]
			     *(arr+0)          *(arr+1)          *(arr+2)
		*/
	
    for (int i = 0; i < n; i++) {
        printf("%d \t", *(arr + i)); // arr[i]
    }

    int *p = arr;
    for (int i = 0; i < n; i++) {
        printf("%d \t", *(p+i));
    }

		// p 和 arr 区别
		printf("sizeof p = %d \n",sizeof(p)); // 8
		printf("sizeof arr = %d \n",sizeof(arr)); // 12

		// 访问数组的时候，下标可以为负数
		int *p2 = &arr[1];
		printf("%d \n",*p2); // 2
		printf("%d \n",p2[1]); // 3
		printf("%d \n",p2[-1]); // 1
		printf("%d \n",*(p2-1)); // 1

		
		int arr2[] = {10,20,30,40,50}
		int *p3 = arr2;
		printf("%d \n",*p3++); // 10 先输出 *p3 再 p3++
		printf("%d \n",(*p3)++); // 20 先输出 *p3 再 *p3 ++
		printf("%d \n",*(p3++)); // 21 先输出 *p3 在 p3++ ，注意这里不是先算 ++ 
		
		
}
```

## 指针加减运算

### 加法运算

- 指针计算不是简单的整数相加
- 如果是一个 int *，+1 的结果是增加一个 int 的大小
- 如果是一个 char *，+1 的结果是增加一个 char 大小

```c
#include <stdio.h>

int main()
{
	int a;
	int *p = &a;
	printf("%d\n", p);
	p += 2; // 移动了 2 个int
	printf("%d\n", p);

	char b = 0;
	char *p1 = &b;
	printf("%d\n", p1);
	p1 += 2; // 移动了 2 个char
	printf("%d\n", p1);

	return 0;
}
```

### 减法运算

```c
#include <stdio.h>

int main()
{
	int a[] = { 1, 2, 3, 4, 5, 6, 7, 8, 9 };
	int *p2 = &a[4]; //第4个元素地址
	int *p1 = &a[1]; //第1个元素地址
	printf("p1 = %p, p2 = %p\n", p1, p2);

	int n1 = p2 - p1; // n1 = 4
	printf("n1 = %d, n2 = %d\n", n1, n2);
	
	return 0;
}
```

## 指针数组

指针数组，它是数组，数组的每个元素都是指针类型

```c
#include "stdio.h"

int main(int argc, char const *argv[]) {
    int a = 10;
    int b = 20;
    int c = 30;

    int *p1 = &a;
    int *p2 = &b;
    int *p3 = &c;

    int *arr[] = {p1, p2, p3}; // 整型指针数组

    printf("%d \n", *(arr[0])); // 10
    printf("%d \n", *(*(arr + 0))); // 10
    printf("%d \n", *(*arr)); // 10
    printf("%d \n", **arr); // 10

}
```
