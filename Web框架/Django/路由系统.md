---
title: 路由系统
description: 
published: true
date: 2021-03-21T15:34:20.326Z
tags: 
editor: markdown
dateCreated: 2021-03-21T15:04:57.620Z
---

# Django 处理 HTTP 请求流程

```diagram
PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIHdpZHRoPSIzNTlweCIgaGVpZ2h0PSIzMDVweCIgdmlld0JveD0iLTAuNSAtMC41IDM1OSAzMDUiIGNvbnRlbnQ9IiZsdDtteGZpbGUgaG9zdD0mcXVvdDtlbWJlZC5kaWFncmFtcy5uZXQmcXVvdDsgbW9kaWZpZWQ9JnF1b3Q7MjAyMS0wMy0yMVQxNDoyNDoyMy43MDBaJnF1b3Q7IGFnZW50PSZxdW90OzUuMCAoWDExOyBMaW51eCB4ODZfNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS84OC4wLjQzMjQuMTgyIFNhZmFyaS81MzcuMzYmcXVvdDsgZXRhZz0mcXVvdDs3QmYzVVFDOUIwSmJ3RG9sNHpkRCZxdW90OyB2ZXJzaW9uPSZxdW90OzE0LjQuOSZxdW90OyB0eXBlPSZxdW90O2VtYmVkJnF1b3Q7Jmd0OyZsdDtkaWFncmFtIGlkPSZxdW90O3NvSkcyenU2V3Y1cndkNlp4MF9fJnF1b3Q7IG5hbWU9JnF1b3Q7UGFnZS0xJnF1b3Q7Jmd0OzdWbGRqNXM0RlAwMWZoMWh6SWY5Q0lSMEg3cWRVV2RYdTMycXJPQUpkQW1PSEdlUzdLL2ZhMk1DRExSZGRhYUpLbVUwaXZEeHhSaWY0M092RTBTeXpmR2Q0dHZ5ZDFtSUd2bGVjVVJrZ1h3LzhqejROTUNwQlVLTVcyQ3RxcUtGdkI1NHJQNFZMWWc3ZEY4Vll1ZXdGdEpTMXJyYWpzR1ZiQnF4MGlPTUt5VVA0N0FuV1JjallNdlhZalFOQXp5dWVDMG1ZWDlWaFM1YmxQcHhqLzhtcW5YWlBSbEhyTzNaOEM3WURid3JlU0VQQTRqa2lHUktTdDFlYlk2WnFNM2FqZGRsK1pYZTg4U1VhUFQvdVNGdzA5Q243dDFFQWEvcW1sTHBVcTVsdyt1OFIxTWw5MDBoekFBZXRQcVk5MUp1QWNRQWZoRmFueHh2Zks4bFFLWGUxSzVYSEN2OTkrRDZreG5xTG5TdHhkR05iQnNuMTNpU2plNm1kVzYzRDhDbXZkTksvaU15V1V0bDM0UEVsQ1lKY1pFRFBJZ0NGaTRBTC9pdXRHK0JYZENTYjZyYVBDK1RlMVVKQmV2eVFRQTM2WFJSM1RydklIRGwxczEzT3VScUxWeFUyRUptUlFlM09TTGVDYmtSV3AwZ1FJbWE2K3A1TEM3dU5Mbyt4NTF2ZlpBVlRNVDMzSGJ5bVgvbndWK0VQUkxpTU9xZTZ6WlhISThIYkdmb3h1aWxBUmVEU2ZXUUZjeThlT2cxeGRNTDV0T2c1MUxpK1NsNklXK3RseEczM3lEU3plV1oxM3MzS01vamxIZ29CZC95L3Z6NEhqNVJIcUIwZ2VnQzViRzVTUElKK3oyM2hvNURXV254dU9YMmhRK1FCOFk4Zm8rVHA2cXVCeXVmK2hsTDBndHk5U3lVRnNkdjh1QjZtVGZhYjZIejFFT2ZHWEJuOStVZ0t3VFI2NG1MYi9iOVJ2Wk5wdHN4dXRaMjdNcWNtN0crRVpQc1dreVNHV01ORVJnR0RheWZVcFFrMEo4OFBGaUhqUkZMb0d1djZpM1hXcWhtZC9QWVdZL0ZnWGM1a3cxblNBU21nRDZNY29ab09FcUtrRGhaaEdocytVMVJHblZFTDg3OHdtQWY3Ky8vK0F5Sk5idi9zTFRVVTNOdm1uODl1Y0pDNlRHN1k1WWEyWWdYbERxSTE5VzZnZVlLbGg5WUlhbFo5Z3BPTTRucjJGUkZZVDFrVGs1algvbXVvcTZrRDUreGNSTDJwL29nL2xRZm9mZDZmVVFUZlJSZmVMT1dkN0NQZDNkYmMrUXpESU1vcUpFR0hIc0gzVXA4UGtkMDhnQ0xBQUd3M0NvblJ6UzlpZUZWWXNDRVR0VVFzSitqQnV6Zmt2ZVBKMjgyVGQ3ZGQwTlhxTU4rbVc5SEpzWHc2M2o4WWFxdWRvSmxNemthVXVvU3BiRnhYc2pVMUIvbTMrNU1DN2s3TTZmY1BvK0h4cVpUNjhaSlp2N2I5RTI5dm1Bek1SaXh6QjZTSVZsUGQveXRTck0rM0kxd2lTcXRzNGtYdGZaTGV0c3MzREtmSUxaRU9XZ2tNMkc1cFowU1Y5d2wxRjZraG5NVEhLS1VERkkwQ0NGR05MTGxmR3F5OUUwQ2N4SWcrSUtGT3A0N2JzSG05MUdDYlYwT1BETXJBV1pMN2ZOVzcwb3p4M1BrYW5lRE1LTUZxQ2RhTjBsNnZTeHNFZGVaQ0hVeEx4VTA1eDFKWUJVVTIzUGc3Q011cjdMNGx4TFpKVlVHemY3bm1QWkw4djQzTFpML0J3PT0mbHQ7L2RpYWdyYW0mZ3Q7Jmx0Oy9teGZpbGUmZ3Q7Ij48ZGVmcy8+PGc+PHBhdGggZD0iTSAxMjAgMjUgTCAyMDIuNjMgMjUiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzc4OGFhMyIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBzdHJva2UtZGFzaGFycmF5PSIzIDMiIHBvaW50ZXItZXZlbnRzPSJzdHJva2UiLz48cGF0aCBkPSJNIDIwNy44OCAyNSBMIDIwMC44OCAyOC41IEwgMjAyLjYzIDI1IEwgMjAwLjg4IDIxLjUgWiIgZmlsbD0iIzc4OGFhMyIgc3Ryb2tlPSIjNzg4YWEzIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHBvaW50ZXItZXZlbnRzPSJhbGwiLz48cGF0aCBkPSJNIDYwIDQ4IEwgNjAgODEuNjMiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzc4OGFhMyIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludGVyLWV2ZW50cz0ic3Ryb2tlIi8+PHBhdGggZD0iTSA2MCA4Ni44OCBMIDU2LjUgNzkuODggTCA2MCA4MS42MyBMIDYzLjUgNzkuODggWiIgZmlsbD0iIzc4OGFhMyIgc3Ryb2tlPSIjNzg4YWEzIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHBvaW50ZXItZXZlbnRzPSJhbGwiLz48cmVjdCB4PSIwIiB5PSIyIiB3aWR0aD0iMTIwIiBoZWlnaHQ9IjQ2IiByeD0iNi45IiByeT0iNi45IiBmaWxsPSIjYjJjOWFiIiBzdHJva2U9IiM3ODhhYTMiIHBvaW50ZXItZXZlbnRzPSJhbGwiLz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMC41IC0wLjUpIj48c3dpdGNoPjxmb3JlaWduT2JqZWN0IHN0eWxlPSJvdmVyZmxvdzogdmlzaWJsZTsgdGV4dC1hbGlnbjogbGVmdDsiIHBvaW50ZXItZXZlbnRzPSJub25lIiB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiByZXF1aXJlZEZlYXR1cmVzPSJodHRwOi8vd3d3LnczLm9yZy9UUi9TVkcxMS9mZWF0dXJlI0V4dGVuc2liaWxpdHkiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogdW5zYWZlIGNlbnRlcjsganVzdGlmeS1jb250ZW50OiB1bnNhZmUgY2VudGVyOyB3aWR0aDogMTE4cHg7IGhlaWdodDogMXB4OyBwYWRkaW5nLXRvcDogMjVweDsgbWFyZ2luLWxlZnQ6IDFweDsiPjxkaXYgc3R5bGU9ImJveC1zaXppbmc6IGJvcmRlci1ib3g7IGZvbnQtc2l6ZTogMDsgdGV4dC1hbGlnbjogY2VudGVyOyAiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgZm9udC1zaXplOiAxMHB4OyBmb250LWZhbWlseTogQ291cmllciBOZXc7IGNvbG9yOiAjNDY0OTVEOyBsaW5lLWhlaWdodDogMS4yOyBwb2ludGVyLWV2ZW50czogYWxsOyB3aGl0ZS1zcGFjZTogbm9ybWFsOyB3b3JkLXdyYXA6IG5vcm1hbDsgIj7moLkgVVJMIOS9jee9rjwvZGl2PjwvZGl2PjwvZGl2PjwvZm9yZWlnbk9iamVjdD48dGV4dCB4PSI2MCIgeT0iMjgiIGZpbGw9IiM0NjQ5NUQiIGZvbnQtZmFtaWx5PSJDb3VyaWVyIE5ldyIgZm9udC1zaXplPSIxMHB4IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj7moLkgVVJMIOS9jee9rjwvdGV4dD48L3N3aXRjaD48L2c+PHBhdGggZD0iTSAxMjAgMTExIEwgMjAyLjYzIDExMSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNzg4YWEzIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHN0cm9rZS1kYXNoYXJyYXk9IjMgMyIgcG9pbnRlci1ldmVudHM9InN0cm9rZSIvPjxwYXRoIGQ9Ik0gMjA3Ljg4IDExMSBMIDIwMC44OCAxMTQuNSBMIDIwMi42MyAxMTEgTCAyMDAuODggMTA3LjUgWiIgZmlsbD0iIzc4OGFhMyIgc3Ryb2tlPSIjNzg4YWEzIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHBvaW50ZXItZXZlbnRzPSJhbGwiLz48cGF0aCBkPSJNIDYwIDEzNCBMIDYwIDE1NCBMIDYwIDE0OSBMIDYwIDE2Mi42MyIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNzg4YWEzIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHBvaW50ZXItZXZlbnRzPSJzdHJva2UiLz48cGF0aCBkPSJNIDYwIDE2Ny44OCBMIDU2LjUgMTYwLjg4IEwgNjAgMTYyLjYzIEwgNjMuNSAxNjAuODggWiIgZmlsbD0iIzc4OGFhMyIgc3Ryb2tlPSIjNzg4YWEzIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHBvaW50ZXItZXZlbnRzPSJhbGwiLz48cmVjdCB4PSIwIiB5PSI4OCIgd2lkdGg9IjEyMCIgaGVpZ2h0PSI0NiIgcng9IjYuOSIgcnk9IjYuOSIgZmlsbD0iI2IyYzlhYiIgc3Ryb2tlPSIjNzg4YWEzIiBwb2ludGVyLWV2ZW50cz0iYWxsIi8+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTAuNSAtMC41KSI+PHN3aXRjaD48Zm9yZWlnbk9iamVjdCBzdHlsZT0ib3ZlcmZsb3c6IHZpc2libGU7IHRleHQtYWxpZ246IGxlZnQ7IiBwb2ludGVyLWV2ZW50cz0ibm9uZSIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgcmVxdWlyZWRGZWF0dXJlcz0iaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHMTEvZmVhdHVyZSNFeHRlbnNpYmlsaXR5Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IHVuc2FmZSBjZW50ZXI7IGp1c3RpZnktY29udGVudDogdW5zYWZlIGNlbnRlcjsgd2lkdGg6IDExOHB4OyBoZWlnaHQ6IDFweDsgcGFkZGluZy10b3A6IDExMXB4OyBtYXJnaW4tbGVmdDogMXB4OyI+PGRpdiBzdHlsZT0iYm94LXNpemluZzogYm9yZGVyLWJveDsgZm9udC1zaXplOiAwOyB0ZXh0LWFsaWduOiBjZW50ZXI7ICI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyBmb250LXNpemU6IDEwcHg7IGZvbnQtZmFtaWx5OiBDb3VyaWVyIE5ldzsgY29sb3I6ICM0NjQ5NUQ7IGxpbmUtaGVpZ2h0OiAxLjI7IHBvaW50ZXItZXZlbnRzOiBhbGw7IHdoaXRlLXNwYWNlOiBub3JtYWw7IHdvcmQtd3JhcDogbm9ybWFsOyAiPuWQhOS4qiBBUFAg55qEdXJscGF0dGVybnM8L2Rpdj48L2Rpdj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PHRleHQgeD0iNjAiIHk9IjExNCIgZmlsbD0iIzQ2NDk1RCIgZm9udC1mYW1pbHk9IkNvdXJpZXIgTmV3IiBmb250LXNpemU9IjEwcHgiIHRleHQtYW5jaG9yPSJtaWRkbGUiPuWQhOS4qiBBUFAg55qEdXJscGF0dGVybnM8L3RleHQ+PC9zd2l0Y2g+PC9nPjxyZWN0IHg9IjIwOSIgeT0iMCIgd2lkdGg9IjEzMiIgaGVpZ2h0PSI1MCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJub25lIiBwb2ludGVyLWV2ZW50cz0iYWxsIi8+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTAuNSAtMC41KSI+PHN3aXRjaD48Zm9yZWlnbk9iamVjdCBzdHlsZT0ib3ZlcmZsb3c6IHZpc2libGU7IHRleHQtYWxpZ246IGxlZnQ7IiBwb2ludGVyLWV2ZW50cz0ibm9uZSIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgcmVxdWlyZWRGZWF0dXJlcz0iaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHMTEvZmVhdHVyZSNFeHRlbnNpYmlsaXR5Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IHVuc2FmZSBjZW50ZXI7IGp1c3RpZnktY29udGVudDogdW5zYWZlIGNlbnRlcjsgd2lkdGg6IDEzMHB4OyBoZWlnaHQ6IDFweDsgcGFkZGluZy10b3A6IDI1cHg7IG1hcmdpbi1sZWZ0OiAyMTBweDsiPjxkaXYgc3R5bGU9ImJveC1zaXppbmc6IGJvcmRlci1ib3g7IGZvbnQtc2l6ZTogMDsgdGV4dC1hbGlnbjogY2VudGVyOyAiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgZm9udC1zaXplOiAxMHB4OyBmb250LWZhbWlseTogQ291cmllciBOZXc7IGNvbG9yOiAjNDY0OTVEOyBsaW5lLWhlaWdodDogMS4yOyBwb2ludGVyLWV2ZW50czogYWxsOyB3aGl0ZS1zcGFjZTogbm9ybWFsOyB3b3JkLXdyYXA6IG5vcm1hbDsgIj7nlLHphY3nva7mlofku7bkuK3nmoQgUk9PVF9VUkxDT05GIOiuvue9rjwvZGl2PjwvZGl2PjwvZGl2PjwvZm9yZWlnbk9iamVjdD48dGV4dCB4PSIyNzUiIHk9IjI4IiBmaWxsPSIjNDY0OTVEIiBmb250LWZhbWlseT0iQ291cmllciBOZXciIGZvbnQtc2l6ZT0iMTBweCIgdGV4dC1hbmNob3I9Im1pZGRsZSI+55Sx6YWN572u5paH5Lu25Lit55qEIFJPT1RfVVJMQ09ORiDorr7nva48L3RleHQ+PC9zd2l0Y2g+PC9nPjxyZWN0IHg9IjIwOSIgeT0iODYiIHdpZHRoPSIxNDkiIGhlaWdodD0iNTAiIGZpbGw9Im5vbmUiIHN0cm9rZT0ibm9uZSIgcG9pbnRlci1ldmVudHM9ImFsbCIvPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0wLjUgLTAuNSkiPjxzd2l0Y2g+PGZvcmVpZ25PYmplY3Qgc3R5bGU9Im92ZXJmbG93OiB2aXNpYmxlOyB0ZXh0LWFsaWduOiBsZWZ0OyIgcG9pbnRlci1ldmVudHM9Im5vbmUiIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIHJlcXVpcmVkRmVhdHVyZXM9Imh0dHA6Ly93d3cudzMub3JnL1RSL1NWRzExL2ZlYXR1cmUjRXh0ZW5zaWJpbGl0eSI+PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiB1bnNhZmUgY2VudGVyOyBqdXN0aWZ5LWNvbnRlbnQ6IHVuc2FmZSBjZW50ZXI7IHdpZHRoOiAxNDdweDsgaGVpZ2h0OiAxcHg7IHBhZGRpbmctdG9wOiAxMTFweDsgbWFyZ2luLWxlZnQ6IDIxMHB4OyI+PGRpdiBzdHlsZT0iYm94LXNpemluZzogYm9yZGVyLWJveDsgZm9udC1zaXplOiAwOyB0ZXh0LWFsaWduOiBjZW50ZXI7ICI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyBmb250LXNpemU6IDEwcHg7IGZvbnQtZmFtaWx5OiBDb3VyaWVyIE5ldzsgY29sb3I6ICM0NjQ5NUQ7IGxpbmUtaGVpZ2h0OiAxLjI7IHBvaW50ZXItZXZlbnRzOiBhbGw7IHdoaXRlLXNwYWNlOiBub3JtYWw7IHdvcmQtd3JhcDogbm9ybWFsOyAiPmRqYW5nby51cmxzLnBhdGgg5oiWIGRqYW5nby51cmxzLnJlX3BhdGgg55qE5a6e5L6LPC9kaXY+PC9kaXY+PC9kaXY+PC9mb3JlaWduT2JqZWN0Pjx0ZXh0IHg9IjI4NCIgeT0iMTE0IiBmaWxsPSIjNDY0OTVEIiBmb250LWZhbWlseT0iQ291cmllciBOZXciIGZvbnQtc2l6ZT0iMTBweCIgdGV4dC1hbmNob3I9Im1pZGRsZSI+ZGphbmdvLnVybHMucGF0aCDmiJYgZGphbmdvLnVybHMuLi48L3RleHQ+PC9zd2l0Y2g+PC9nPjxwYXRoIGQ9Ik0gNjAgMjE1IEwgNjAgMjUxLjYzIiBmaWxsPSJub25lIiBzdHJva2U9IiM3ODhhYTMiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgcG9pbnRlci1ldmVudHM9InN0cm9rZSIvPjxwYXRoIGQ9Ik0gNjAgMjU2Ljg4IEwgNTYuNSAyNDkuODggTCA2MCAyNTEuNjMgTCA2My41IDI0OS44OCBaIiBmaWxsPSIjNzg4YWEzIiBzdHJva2U9IiM3ODhhYTMiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgcG9pbnRlci1ldmVudHM9ImFsbCIvPjxwYXRoIGQ9Ik0gMTIwIDE5MiBMIDI2MCAxOTIgTCAyNjAgMjUxLjYzIiBmaWxsPSJub25lIiBzdHJva2U9IiM3ODhhYTMiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgc3Ryb2tlLWRhc2hhcnJheT0iMyAzIiBwb2ludGVyLWV2ZW50cz0ic3Ryb2tlIi8+PHBhdGggZD0iTSAyNjAgMjU2Ljg4IEwgMjU2LjUgMjQ5Ljg4IEwgMjYwIDI1MS42MyBMIDI2My41IDI0OS44OCBaIiBmaWxsPSIjNzg4YWEzIiBzdHJva2U9IiM3ODhhYTMiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgcG9pbnRlci1ldmVudHM9ImFsbCIvPjxyZWN0IHg9IjAiIHk9IjE2OSIgd2lkdGg9IjEyMCIgaGVpZ2h0PSI0NiIgcng9IjYuOSIgcnk9IjYuOSIgZmlsbD0iI2IyYzlhYiIgc3Ryb2tlPSIjNzg4YWEzIiBwb2ludGVyLWV2ZW50cz0iYWxsIi8+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTAuNSAtMC41KSI+PHN3aXRjaD48Zm9yZWlnbk9iamVjdCBzdHlsZT0ib3ZlcmZsb3c6IHZpc2libGU7IHRleHQtYWxpZ246IGxlZnQ7IiBwb2ludGVyLWV2ZW50cz0ibm9uZSIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgcmVxdWlyZWRGZWF0dXJlcz0iaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHMTEvZmVhdHVyZSNFeHRlbnNpYmlsaXR5Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IHVuc2FmZSBjZW50ZXI7IGp1c3RpZnktY29udGVudDogdW5zYWZlIGNlbnRlcjsgd2lkdGg6IDExOHB4OyBoZWlnaHQ6IDFweDsgcGFkZGluZy10b3A6IDE5MnB4OyBtYXJnaW4tbGVmdDogMXB4OyI+PGRpdiBzdHlsZT0iYm94LXNpemluZzogYm9yZGVyLWJveDsgZm9udC1zaXplOiAwOyB0ZXh0LWFsaWduOiBjZW50ZXI7ICI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyBmb250LXNpemU6IDEwcHg7IGZvbnQtZmFtaWx5OiBDb3VyaWVyIE5ldzsgY29sb3I6ICM0NjQ5NUQ7IGxpbmUtaGVpZ2h0OiAxLjI7IHBvaW50ZXItZXZlbnRzOiBhbGw7IHdoaXRlLXNwYWNlOiBub3JtYWw7IHdvcmQtd3JhcDogbm9ybWFsOyAiPuivt+axgueahCBVUkwg5Yy56YWN5Yiw56ys5LiA5Liq5YGc5q2iPC9kaXY+PC9kaXY+PC9kaXY+PC9mb3JlaWduT2JqZWN0Pjx0ZXh0IHg9IjYwIiB5PSIxOTUiIGZpbGw9IiM0NjQ5NUQiIGZvbnQtZmFtaWx5PSJDb3VyaWVyIE5ldyIgZm9udC1zaXplPSIxMHB4IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj7or7fmsYLnmoQgVVJMIOWMuemFjeWIsOesrOS4gOS4quWBnOatojwvdGV4dD48L3N3aXRjaD48L2c+PHJlY3QgeD0iMCIgeT0iMjU4IiB3aWR0aD0iMTIwIiBoZWlnaHQ9IjQ2IiByeD0iNi45IiByeT0iNi45IiBmaWxsPSIjYjJjOWFiIiBzdHJva2U9IiM3ODhhYTMiIHBvaW50ZXItZXZlbnRzPSJhbGwiLz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMC41IC0wLjUpIj48c3dpdGNoPjxmb3JlaWduT2JqZWN0IHN0eWxlPSJvdmVyZmxvdzogdmlzaWJsZTsgdGV4dC1hbGlnbjogbGVmdDsiIHBvaW50ZXItZXZlbnRzPSJub25lIiB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiByZXF1aXJlZEZlYXR1cmVzPSJodHRwOi8vd3d3LnczLm9yZy9UUi9TVkcxMS9mZWF0dXJlI0V4dGVuc2liaWxpdHkiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogdW5zYWZlIGNlbnRlcjsganVzdGlmeS1jb250ZW50OiB1bnNhZmUgY2VudGVyOyB3aWR0aDogMTE4cHg7IGhlaWdodDogMXB4OyBwYWRkaW5nLXRvcDogMjgxcHg7IG1hcmdpbi1sZWZ0OiAxcHg7Ij48ZGl2IHN0eWxlPSJib3gtc2l6aW5nOiBib3JkZXItYm94OyBmb250LXNpemU6IDA7IHRleHQtYWxpZ246IGNlbnRlcjsgIj48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IGZvbnQtc2l6ZTogMTBweDsgZm9udC1mYW1pbHk6IENvdXJpZXIgTmV3OyBjb2xvcjogIzQ2NDk1RDsgbGluZS1oZWlnaHQ6IDEuMjsgcG9pbnRlci1ldmVudHM6IGFsbDsgd2hpdGUtc3BhY2U6IG5vcm1hbDsgd29yZC13cmFwOiBub3JtYWw7ICI+5Yy56YWN5oiQ5Yqf77yM6LCD55So55u45YWz55qE6KeG5Zu+PC9kaXY+PC9kaXY+PC9kaXY+PC9mb3JlaWduT2JqZWN0Pjx0ZXh0IHg9IjYwIiB5PSIyODQiIGZpbGw9IiM0NjQ5NUQiIGZvbnQtZmFtaWx5PSJDb3VyaWVyIE5ldyIgZm9udC1zaXplPSIxMHB4IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj7ljLnphY3miJDlip/vvIzosIPnlKjnm7jlhbPnmoTop4blm748L3RleHQ+PC9zd2l0Y2g+PC9nPjxyZWN0IHg9IjIwMCIgeT0iMjU4IiB3aWR0aD0iMTIwIiBoZWlnaHQ9IjQ2IiByeD0iNi45IiByeT0iNi45IiBmaWxsPSIjYjJjOWFiIiBzdHJva2U9IiM3ODhhYTMiIHBvaW50ZXItZXZlbnRzPSJhbGwiLz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMC41IC0wLjUpIj48c3dpdGNoPjxmb3JlaWduT2JqZWN0IHN0eWxlPSJvdmVyZmxvdzogdmlzaWJsZTsgdGV4dC1hbGlnbjogbGVmdDsiIHBvaW50ZXItZXZlbnRzPSJub25lIiB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiByZXF1aXJlZEZlYXR1cmVzPSJodHRwOi8vd3d3LnczLm9yZy9UUi9TVkcxMS9mZWF0dXJlI0V4dGVuc2liaWxpdHkiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogdW5zYWZlIGNlbnRlcjsganVzdGlmeS1jb250ZW50OiB1bnNhZmUgY2VudGVyOyB3aWR0aDogMTE4cHg7IGhlaWdodDogMXB4OyBwYWRkaW5nLXRvcDogMjgxcHg7IG1hcmdpbi1sZWZ0OiAyMDFweDsiPjxkaXYgc3R5bGU9ImJveC1zaXppbmc6IGJvcmRlci1ib3g7IGZvbnQtc2l6ZTogMDsgdGV4dC1hbGlnbjogY2VudGVyOyAiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgZm9udC1zaXplOiA3cHg7IGZvbnQtZmFtaWx5OiBDb3VyaWVyIE5ldzsgY29sb3I6ICM0NjQ5NUQ7IGxpbmUtaGVpZ2h0OiAxLjI7IHBvaW50ZXItZXZlbnRzOiBhbGw7IHdoaXRlLXNwYWNlOiBub3JtYWw7IHdvcmQtd3JhcDogbm9ybWFsOyAiPuayoeacieaJvuWIsOaIluWFtuS7lumUmeivr++8jERqYW5nbyDliJnosIPnlKjkuIDkuKrlpITnkIbplJnor6/nmoTop4blm748L2Rpdj48L2Rpdj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PHRleHQgeD0iMjYwIiB5PSIyODMiIGZpbGw9IiM0NjQ5NUQiIGZvbnQtZmFtaWx5PSJDb3VyaWVyIE5ldyIgZm9udC1zaXplPSI3cHgiIHRleHQtYW5jaG9yPSJtaWRkbGUiPuayoeacieaJvuWIsOaIluWFtuS7lumUmeivr++8jERqYW5nbyDliJnosIPnlKjkuIDkuKrlpITnkIbplJnor6/nmoTop4blm748L3RleHQ+PC9zd2l0Y2g+PC9nPjwvZz48c3dpdGNoPjxnIHJlcXVpcmVkRmVhdHVyZXM9Imh0dHA6Ly93d3cudzMub3JnL1RSL1NWRzExL2ZlYXR1cmUjRXh0ZW5zaWJpbGl0eSIvPjxhIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAsLTUpIiB4bGluazpocmVmPSJodHRwczovL3d3dy5kaWFncmFtcy5uZXQvZG9jL2ZhcS9zdmctZXhwb3J0LXRleHQtcHJvYmxlbXMiIHRhcmdldD0iX2JsYW5rIj48dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LXNpemU9IjEwcHgiIHg9IjUwJSIgeT0iMTAwJSI+Vmlld2VyIGRvZXMgbm90IHN1cHBvcnQgZnVsbCBTVkcgMS4xPC90ZXh0PjwvYT48L3N3aXRjaD48L3N2Zz4=
```

一旦有 URL 匹配成功，Djagno 导入并调用相关的视图，这个视图是一个Python 函数（或基于类的视图 class-based view ）。视图会获得如下参数：

1. 一个 HTTPRequest 对象实例
2. 如果匹配的 URL 模式字符串不包含任何组 ， 那么匹配的信息会作为位置参数传递给视图 。
3. 如果 URL 模式字符串 中的参数给定了参数名， 那么匹配的信息会作为命名参数传递给视图 。

```python
from django.urls import path

from . import views

urlpatterns = [
    path('articles/2003/', views.special_case_2003),
    path('articles/<int:year>/', views.year_archive),
    path('articles/<int:year>/<int:month>/', views.month_archive),
    path('articles/<int:year>/<int:month>/<slug:slug>/', views.article_detail),
]
```

- 第一个参数是 URL 模式字符串：`articles/<int:year>/`
- 第二个参数是，处理 URL 请求的视图函数：`year_archive`
- 使用尖括号提取 URL 中的参数：`<int:year>`
- URL 模式字符串不需要以 `/` 开头
- 可使用类型转化器对参数类型进行转换，如 `int:` 会将从 URL 中捕获的值转换为数值类型，如果没有指定类型转换器，如 `<year>`，则任何不包含 `/` 的字符串都会被提取。

例如：

- 请求 `/articles/2500/03` 会匹配第三个 URL 模式字符串，匹配成功，Django 调用 `views.month_archive(request, year=2005, month=3)`
- 请求 `/articles/2003/` 将匹配列表中的第一个模式不是第二个，因为模式按顺序匹配，第一个会首先测试是否匹配。在这里 Django 会调用函数 `views.special_case_2003(request)`
- 请求 `/articles/2003` 不匹配任何一个模式，因为每个模式要求 URL 以一个斜线结尾
- 请求 `/articles/2003/03/building-a-django-site/` 会匹配 URL 列表中的最后一项。Django 会调用函数 `views.article_detail(request, year=2003, month=3, slug="building-a-django-site")` 

# URL 参数类型转换器

- `str`：匹配任意非空字符串，但是不能匹配 URL 分隔符 `/`。 这是默认的 URL 参数转换器。
- `int`：匹配任意大于等于 0 的整数 。
- `slug`：匹配任意 `slug` 字符串，`slug`字符串可以包含任意 ASCII 字符、数字、中划线和下画线
- `uuid`：匹配 `UUID` 字符串。例如：`075194d3-6885-417e-a8a8-6c93le272tDO`
- `path`：匹配任意非空字符串，包括 URL 分隔符 "/" 。这允许匹配完成的 URL 而不是 URL 的一个片段 

## 自定义 URL 参数类型转换器

自定义参数类型转换器包括以下几部分：

- 一个`regex`属性，属性值为正则表达式
- 一个`to_python(self,value)` 方法，该方法用于将匹配的 URL 参数转换为指定类型，当类型转换失败后抛出 ValueError 异常
- 一个`to_url(self, value)`方法，该方法用于将 Python 类型转换为类型转换器字符串

下面是一个用于捕获日期年的类型转换器：

```python
class FourDigitYearConverter:
    regex = '[0-9]{4}'

    def to_python(self, value):
        return int(value)

    def to_url(self, value):
        return '%04d' % value
```

然后在 URLconf 中使用 `register_converter()` 来注册自定义的转换器类：

```python
from django.urls import path, register_converter

from . import converters, views

register_converter(converters.FourDigitYearConverter, 'yyyy')

urlpatterns = [
    path('articles/2003/', views.special_case_2003),
    path('articles/<yyyy:year>/', views.year_archive),
    ...
]
```

# 使用正则

Python 的正则表达式支持对分组进行命名，语法格式为：`(？P<name>pattern)`，其中 name
为分组名， pattern 为匹配的正则表达式 。使用正则表达式对前面的 URLconf 进行重写效果如下：

```python
from django.urls import path, re_path

from . import views

urlpatterns = [
    path('articles/2003/', views.special_case_2003),
    re_path(r'^articles/(?P<year>[0-9]{4})/$', views.year_archive),
    re_path(r'^articles/(?P<year>[0-9]{4})/(?P<month>[0-9]{2})/$', views.month_archive),
    re_path(r'^articles/(?P<year>[0-9]{4})/(?P<month>[0-9]{2})/(?P<slug>[\w-]+)/$', views.article_detail),
]
```

正则表达式可以嵌套使用，如：

```python
re_path(r'^comments/(?:page-(?P<page_number>\d+)/)?$', comments)
```

# include 导入其他 URLconf

一个工程通常有很多 URL ，如果将这些 URL 都写在 URLconf 根模块中，那么 URLconf 将会变得非常脚肿，不利于维护。对于这种情况，常用的解决办法就是为每一个应用程序写一套独立的 URLconf，而 URLconf 根模块通过使用 `include()` 方法将其他 URLconf 引用进来。

```python
from django.urls import include, path

from apps.main import views as main_views
from credit import views as credit_views

extra_patterns = [
    path('reports/', credit_views.report),
    path('reports/<int:id>/', credit_views.report),
    path('charge/', credit_views.charge),
]

urlpatterns = [
    path('', main_views.homepage),
    path('help/', include('apps.help.urls')),
    path('credit/', include(extra_patterns)),
    path('admin/', admin.site.urls)
]
```

# 向视图传递额外参数

使用 `path()` 方法的第三个参数向视图传递额外参数，例如：

```python
from django.urls import path
from . import views

urlpatterns = [
    path('blog/<int:year>/', views.year_archive, {'foo': 'bar'}),
]
```

在这个例子里，当请求到 `/blog/2005/` 时，Django 将调用 `views.year_archive(request, year=2005, foo='bar')` 。

也可以向 `include()` 方法传递额外参数，例如：

```python
# main.py
from django.urls import include, path

urlpatterns = [
    path('blog/', include('inner'), {'blog_id': 3}),
]

# inner.py
from django.urls import path
from mysite import views

urlpatterns = [
    path('archive/', views.archive),
    path('about/', views.about),
]
```

此时，额外参数 `{'blog_id': 3}` 将会被传递给每一个被引用的 URL 。

# 动态生成 URL

在网页应用中，很多情况下需要动态编写 URL ，而不是用户直接在浏览器中输入 URL。用以下 URL 模式字符串为例，看看如何在 Django 模板和视图中动态生成 URL：

```python
path('articles/<int:year>/', views.year_archive, name='news-year-archive'),
```

1. 使用 url 标签在模板中动态生成 URL

```jinja2
{# 使用固定参数 #}
<a href="{% url 'news-year-archive' 2012 %}">2012 Archive</a>

{# 使用动态变量 #}
<ul>
{% for yearvar in year_list %}
<li><a href="{% url 'news-year-archive' yearvar %}">{{ yearvar }} Archive</a></li>
{% endfor %}
</ul>
```

2. 使用 `reverse()` 方法在 Python 代码中生成 URL

```python
from django.http import HttpResponseRedirect
from django.urls import reverse

def redirect_to_year(request):
    # ...
    year = 2006
    # ...
    return HttpResponseRedirect(reverse('news-year-archive', args=(year,)))
```

# URL 名字和命名空间






